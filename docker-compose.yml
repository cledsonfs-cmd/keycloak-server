keycloak:
  image: quay.io/keycloak/keycloak:21.1.1
  volumes:
    - ./kc-dist:/opt/keycloak   # <<< usa versÃ£o buildada
  environment:
    KC_DB: postgres
    KC_DB_URL_HOST: postgres
    KC_DB_USERNAME: keycloak
    KC_DB_PASSWORD: CFSpgss1976@
    KC_DB_SCHEMA: public

    KEYCLOAK_ADMIN: admin
    KEYCLOAK_ADMIN_PASSWORD: CFSpgss1976@

    JAVA_OPTS: >
      -Xms256m
      -Xmx512m
      -XX:MetaspaceSize=96m
      -XX:MaxMetaspaceSize=150m

  command: start

  deploy:
    resources:
      limits:
        memory: 800m

  ports:
    - "8080:8080"
  depends_on:
    - postgres
  networks:
    - keycloak_network
